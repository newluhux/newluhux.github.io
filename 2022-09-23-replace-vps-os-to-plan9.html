<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2022-09-26 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>&lrm;</title>
<meta name="author" content="Lu Hui" />
<meta name="generator" content="Org Mode" />
</head>
<body>
<div id="content" class="content">
<div id="outline-container-org3f97b05" class="outline-2">
<h2 id="org3f97b05">use 9front replace vps&rsquo;s operating system</h2>
<div class="outline-text-2" id="text-org3f97b05">
<p>
You can test this blog on local virtual machine
</p>
</div>

<div id="outline-container-orgc8c29b9" class="outline-3">
<h3 id="orgc8c29b9">Need</h3>
<div class="outline-text-3" id="text-orgc8c29b9">
</div>
<div id="outline-container-org522d6c4" class="outline-4">
<h4 id="org522d6c4">out-of-band management console</h4>
<div class="outline-text-4" id="text-org522d6c4">
<p>
Need a out-of-band management console to connect vps&rsquo;s screen
</p>
</div>
</div>

<div id="outline-container-org133e99c" class="outline-4">
<h4 id="org133e99c">kvm or bare metal</h4>
<div class="outline-text-4" id="text-org133e99c">
<p>
OpenVZ or other container technology not discussed here
</p>
</div>
</div>
</div>

<div id="outline-container-orgf4f93da" class="outline-3">
<h3 id="orgf4f93da">Stage 0 boot a linux in RAM</h3>
<div class="outline-text-3" id="text-orgf4f93da">
</div>
<div id="outline-container-org075e089" class="outline-4">
<h4 id="org075e089">Download iPXE image</h4>
<div class="outline-text-4" id="text-org075e089">
<p>
MBR:
</p>

<div class="org-src-container">
<pre class="src src-shell"><code>wget http://boot.salstar.sk/ipxe/ipxe.usb  </code>
</pre>
</div>
</div>
</div>

<div id="outline-container-org5c45b6f" class="outline-4">
<h4 id="org5c45b6f">Write iPXE image to disk</h4>
<div class="outline-text-4" id="text-org5c45b6f">
<div class="org-src-container">
<pre class="src src-shell"><code>sync # ensure data is sync to disk</code>
<code>dd if=ipxe.usb of=/dev/vda conv=sync # write image to harddisk</code>
<code>reboot -f # restart now</code>
</pre>
</div>
</div>
</div>

<div id="outline-container-org080aa6d" class="outline-4">
<h4 id="org080aa6d">use iPXE boot a linux in RAM</h4>
<div class="outline-text-4" id="text-org080aa6d">
<p>
now please connect vps&rsquo;s screen, use out-of-band management console
</p>

<p>
note: if vps privoder not have network autoconf, you may be need configure network manual
</p>

<p>
If it success, you now can seem a menu.
</p>

<p>
please select &rsquo;slackware&rsquo; to boot
</p>

<p>
if it failed:
</p>

<pre class="example">
<code>booting from Hard Disk...</code>
<code>iPXE initialising devices...ok</code>
<code></code>
<code></code>
<code></code>
<code>iPXE 1.21.1+ (g081b3) -- Open Source Network Boot Firmware -- https://ipxe.org</code>
<code>Features: DNS FTP HTTP HTTPS iSCSI TFTP SRP VLAN AoE ELF MBOOT PXE bzImage Menu </code>
<code>PXEXT</code>
<code></code>
<code>boot.salstar.sk - SAL's boot menu</code>
<code></code>
<code>Waiting for link-up on net0... ok</code>
<code>Configuring (net0 52:54:00:12:34:56)...... ok</code>
<code>IP: 10.0.2.15, netmask: 255.255.255.0, gateway: 10.0.2.2</code>
<code>Could not get time and date: Connection timed out (https://ipxe.org/4c496035)</code>
<code>https://boot.salstar.sk/by_mac/52:54:00:12:34:56... Network unreachable (https:/</code>
<code>/ipxe.org/280a6011)</code>
<code>https://boot.salstar.sk/by_ip/10.0.2.15... Network unreachable (https://ipxe.org</code>
<code>/280a6011)</code>
<code>https://boot.salstar.sk/menu.ipxe... Network unreachable (https://ipxe.org/280a6</code>
<code>011)</code>
<code>Press any key to enter failsafe menu ...</code>
</pre>

<p>
please press ENTER to start failsafe menu.
</p>

<p>
select &rsquo;Start iPXE shell&rsquo;
</p>

<p>
iPXE shell:
</p>

<pre class="example">
<code>iPXE&gt; </code>
</pre>

<p>
you can boot &rsquo;slackware&rsquo; by:
</p>

<pre class="example">
<code>kernel ftp://&lt;ip addr or domain name&gt;/slackware/slackware64-current/kernels/huge.s/bzImage</code>
<code>initrd ftp://&lt;ip addr or domain name&gt;/slackware/slackware64-current/isolinux/initrd.img</code>
<code>boot</code>
</pre>

<p>
note: if your dns not working, please use ip address instead domain name.
</p>
</div>
</div>
</div>

<div id="outline-container-orgf412a04" class="outline-3">
<h3 id="orgf412a04">Stage 1 download 9front image and write to disk</h3>
<div class="outline-text-3" id="text-orgf412a04">
</div>
<div id="outline-container-orgbef6e17" class="outline-4">
<h4 id="orgbef6e17">Download 9front image</h4>
<div class="outline-text-4" id="text-orgbef6e17">
<p>
use root login, then:
</p>

<div class="org-src-container">
<pre class="src src-shell"><code>dhcpcd eth0 # setup network</code>
<code>wget http://9front.org/iso/9front-&lt;version&gt;.amd64.iso.gz # download</code>
</pre>
</div>
</div>
</div>

<div id="outline-container-orga3ec3d4" class="outline-4">
<h4 id="orga3ec3d4">write 9front image to disk</h4>
<div class="outline-text-4" id="text-orga3ec3d4">
<div class="org-src-container">
<pre class="src src-shell"><code>zcat 9front-&lt;version&gt;.amd64.iso.gz | dd bs=1M of=/dev/vda conv=sync # write</code>
<code>sync # ensure sync to disk</code>
<code>reboot # reboot</code>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org43b206e" class="outline-3">
<h3 id="org43b206e">Stage 2 install 9front</h3>
<div class="outline-text-3" id="text-org43b206e">
<p>
now you can install 9front.
</p>

<p>
but have some notice:
</p>
</div>

<div id="outline-container-org457a83d" class="outline-4">
<h4 id="org457a83d">configfs</h4>
<div class="outline-text-4" id="text-org457a83d">
<p>
if vps&rsquo;s disk size is small , please use hjfs.
</p>
</div>
</div>

<div id="outline-container-org6b92b14" class="outline-4">
<h4 id="org6b92b14">prepdisk</h4>
<div class="outline-text-4" id="text-org6b92b14">
<p>
in prepdisk phases, you can&rsquo;t remove installation image&rsquo;s part.
</p>

<p>
safe method is create a new part in space outside the installation image
</p>

<pre class="example">
<code>If there is enough room, a Plan 9 partition will be</code>
<code>suggested; you can probably just type 'w' and then 'q'.</code>
<code></code>
<code>cylinder = 1048576 bytes</code>
<code>   empty                 0 463          (463 cylinders, 463.00 MB)</code>
<code>   * p1                  463 464        (1 cylinders, 1.00 MB) ESP</code>
<code>  '  p2                  464 4560       (4096 cylinders, 4.00 GB) PLAN9 # this is new part , outside of installation image</code>
<code>&gt;&gt;&gt; w</code>
<code>&gt;&gt;&gt; q</code>
</pre>
</div>
</div>
</div>

<div id="outline-container-org7cf6f33" class="outline-3">
<h3 id="org7cf6f33">All is done</h3>
<div class="outline-text-3" id="text-org7cf6f33">
<p>
after installation, all is done, reboot your vps and use 9front!
</p>
</div>
</div>


<div id="outline-container-org78a363e" class="outline-3">
<h3 id="org78a363e">References</h3>
<div class="outline-text-3" id="text-org78a363e">
<p>
<a href="http://boot.salstar.sk/">http://boot.salstar.sk/</a>
</p>

<p>
<a href="http://9front.org/releases/">http://9front.org/releases/</a>
</p>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p>Last updated: 2022-09-26</p>
</div>
</body>
</html>
